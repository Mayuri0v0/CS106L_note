---
description: Special operations within your classes!
---

# 12. Special Member Functions

## Overview

一共有 **6** 个特殊成员函数, 这些函数在没有显式定义时会自动生成

* 默认构造函数
  * 无参数, 创建一个新对象时调用
* 析构函数
  * 当一个对象脱离作用域时自动调用
* 拷贝构造函数
  * 创建一个对象的副本时调用(默认浅拷贝)
* 拷贝赋值操作符
  * 执行对象间的`=` 时自动调用
* 移动构造函数
  * 使用右值(即将被销毁)初始化同类型对象时调用
  * 使用`std::move` 时调用
* 移动赋值操作符
  *

```cpp
class Widget {
    public:
        Widget();                            // default constructor
        Widget(const Widget& w);             // copy constructor
        Widget& operator = (const Widget& w);// copy assignment operator
        ~Widget();                           // destructor
        Widget(Widget&& rhs);                // move constructor
        Widget& operator = (Widget&& rhs);   // move assignment operator
```



## Copy and copy assignment

在默认情况下, 对象的复制是浅拷贝, 如果想要进行深拷贝, 需要自行Override函数.



## Default and delete

### delete

我们可以删除特殊成员函数:

```cpp
PasswordManager(const PasswordManager& rhs) = delete;
PasswordManager& operator = (const PasswordManager& rhs) = delete;
```

此时复制操作会产生编译错误.



### default

```cpp
PasswordManager();
PasswordManager(const PasswordManager& pm) = default; // 默认浅拷贝
```

`default` 关键字声明一个默认的函数



### The Rule of 0

{% hint style="danger" %}
如果默认特殊成员函数正常工作, **不要自行定义**!
{% endhint %}

只在默认函数行为错误时重新定义:

* 比如成员包含指针, 需要深拷贝



### The Rule of 3

{% hint style="danger" %}
当你需要定义 **析构函数**, **拷贝构造函数**, **拷贝赋值操作符**时, **同时定义三个**!
{% endhint %}

* 当你需要定义其中一个, 说明你需要手动管理某些资源
* 这意味着, 复制, 析构时, 我们都需要手动管理它们



## Move and move assignment

